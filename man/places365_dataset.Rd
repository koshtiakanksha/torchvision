% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/dataset-places365.R
\name{places365_dataset}
\alias{places365_dataset}
\title{Places365 Dataset}
\usage{
places365_dataset(
  root = tempdir(),
  split = c("train", "val", "test"),
  transform = NULL,
  target_transform = NULL,
  download = FALSE,
  small = TRUE,
  loader = magick_loader
)
}
\arguments{
\item{root}{Root directory for dataset storage. The dataset will be stored under \verb{root/<dataset-name>}. Defaults to \code{tempdir()}.}

\item{split}{One of \code{"train"}, \code{"val"}, or \code{"test"}.}

\item{transform}{Optional. A function that takes an image and returns a transformed version (e.g., normalization, cropping).}

\item{target_transform}{Optional. A function that transforms the label.}

\item{download}{Logical. If TRUE, downloads the dataset to \verb{root/}. If the dataset is already present, download is skipped.}

\item{small}{Logical, defaults to \code{TRUE}. If \code{TRUE}, uses the 256 x 256
#'   "small" images (~30 GB total). If \code{FALSE}, uses the high-resolution version (~160 GB total).}

\item{loader}{A function to load an image given its path. Defaults to
\code{\link[=magick_loader]{magick_loader()}}, which uses the \code{{magick}} package.}
}
\value{
A torch dataset of class \code{places365_dataset}. Each element is a named
list with:
\itemize{
\item \code{x}: the image as loaded (or transformed if \code{transform} is set).
\item \code{y}: the integer class label (not returned for the test split).
}
}
\description{
Loads the MIT Places365 dataset for scene classification.
}
\details{
The dataset is split into:
\itemize{
\item \code{"train"}: images are organized by class folder.
\item \code{"val"}: images are in a flat directory and matched with a label file.
\item \code{"test"}: images are in a flat directory with no labels.
}
}
\examples{
\dontrun{
ds <- places365_dataset(
  split = "val",
  download = TRUE,
  small = TRUE,
  transform = transform_to_tensor
)
item <- ds[1]
tensor_image_browse(item$x)

# Show class index and label
label_idx <- item$y
label_name <- ds$classes[label_idx]
cat("Label index:", label_idx, "Class name:", label_name, "\n")

dl <- dataloader(ds, batch_size = 2)
batch <- dataloader_next(dataloader_make_iter(dl))
batch$x
}

}
\seealso{
Other classification_dataset: 
\code{\link{caltech_dataset}},
\code{\link{cifar10_dataset}()},
\code{\link{eurosat_dataset}()},
\code{\link{fer_dataset}()},
\code{\link{fgvc_aircraft_dataset}()},
\code{\link{flowers102_dataset}()},
\code{\link{mnist_dataset}()},
\code{\link{oxfordiiitpet_dataset}()},
\code{\link{tiny_imagenet_dataset}()}
}
\concept{classification_dataset}
